<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>自由配置型食品認知マップ研究</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="app" class="screen-container">
        <div id="screen1" class="screen">
            <h2>被験者情報を入力してください</h2>
            <input id="subjectName" type="text" placeholder="お名前" required autocomplete="name">
            <input id="subjectAge" type="number" placeholder="年齢" min="18" max="99" required autocomplete="age">
            <input id="subjectEmail" type="email" placeholder="メールアドレス" required autocomplete="email">
            <button id="goToScreen2Btn">次へ</button>
            <p class="info-text">※入力された情報は、研究目的以外には使用されません。</p>
        </div>

        <div id="screen2" class="screen">
    <h2>実験のやり方・注意事項</h2>
    
    <p>この実験では、様々な<strong>食品の画像</strong>を画面に表示します。この白い画面は、あなたの<strong>「頭の中」や「思考のテーブル」</strong>だと思ってください。ドラッグ＆ドロップで食品を動かすことは、机の上でカードを整理しながら、考えをまとめる作業と同じです。</p>
    <p>画面上の<strong>「距離」</strong>は、あなたの頭の中にある<strong>「関係性の強さ」</strong>を表します。あなただけの「頭の中の地図」を作るつもりで、楽しんで配置してみてください。</p>
    
    <ul>
        <li>
            <strong>配置フェーズ</strong>: 
            食品画像の上にある<strong>青いバー</strong>をドラッグ＆ドロップして、自由に移動・配置してください。<br>
            <ul>
                <li><strong>「関連が強い」「一緒に思い浮かぶ」</strong>と感じる食品同士は、<strong>物理的に近くに</strong>配置してください。</li>
                <li>逆に「関連が薄い」「全く別の文脈で考える」食品同士は、<strong>思い切って遠くに</strong>離してみてください。</li>
            </ul>
            「関係性」に正解はありません。例えば、「調理法が似ている」「同じ食事のシーンで食べる」「味の方向性が近い」「個人的な思い出や好み」といった、あなたが直感で感じる<strong>「つながり」</strong>を自由に表現してください。各食品の上にある<strong>丸い[i]ボタン</strong>をクリックすると、その食品の情報を右側のパネルで確認できます。
        </li>
        <li>
            <strong>クラスター作成フェーズ</strong>: 
            全ての食品を配置し終えたら、「配置を確定する」ボタンを押してください。その後、<strong>マウスで食品を円で囲む</strong>ことでクラスター（グループ）を作成できます。関連性が高いと感じる食品を<strong>3つ以上</strong>含むクラスターを作成し、そのクラスターに名前を付けてください。
        </li>
        <li>
            <strong>フィードバックフェーズ</strong>: 
            全てのクラスターを作成し終えたら、「クラスターレビューへ進む」ボタンを押してください。その後、作成した各クラスターについて、なぜ作成したかなどの質問に回答していただきます。
        </li>
    </ul>

    <p>操作に関する不明点があれば、研究者に確認してください。それでは、準備ができたら「実験開始」ボタンを押してください。</p>
    <button id="startExperimentBtn">実験開始</button>
    <button id="backToScreen1Btn" class="back-button">前の画面に戻る</button> 
</div>

        <div id="screen3" class="screen">
            <h1>自由配置型食品認知マップ</h1>
            <div class="experiment-layout-container">
                <div class="canvas-area">
                    <div id="canvas-container">
                        <canvas id="clusterCanvas"></canvas>
                    </div>
                </div>
                <div id="details-panel" class="details-area">
                    <h3 id="details-food-name"></h3>
                    <img id="details-food-image" src="" alt="選択された食品の画像" style="display:none;">
                    <div id="details-food-info"></div>
                    <p id="details-placeholder" class="info-text" style="display:block;">食品の[i]ボタンをクリックすると、ここに詳細情報が表示されます。</p>
                </div>
            </div>
            <div class="button-controls">
                <button id="backToScreen2Btn" class="back-button">前の画面に戻る</button> 
                <button id="finishPlacementBtn">配置を確定する</button>
                <button id="goToFeedbackBtn" style="display:none;">クラスターレビューへ進む</button>
                <button id="saveFeedbackAndDataBtn" style="display:none;">全てのフィードバックを記入しデータ保存</button>
            </div>
            <div class="spinner" id="loadingSpinner"></div>
            <p class="info-text" id="statusMessage"></p>
        </div>

       <div id="screen4" class="screen">
            <h2>アンケートにご協力ください</h2>
            <p>実験の体験や、あなたの普段の食生活についてお伺いします。</p>
            <form id="surveyForm" class="survey-container">

                <fieldset class="survey-section">
                    <legend>A. 実験の全体的な感想について</legend>
                    <div class="survey-question">
                        <p class="question-text">1. 今回の実験は楽しかった</p>
                        <div class="likert-scale">
                            <span>全くそう思わない</span>
                            <div class="likert-options">
                                <label><input type="radio" name="q1_fun" value="1" required><span>1</span></label>
                                <label><input type="radio" name="q1_fun" value="2"><span>2</span></label>
                                <label><input type="radio" name="q1_fun" value="3"><span>3</span></label>
                                <label><input type="radio" name="q1_fun" value="4"><span>4</span></label>
                                <label><input type="radio" name="q1_fun" value="5"><span>5</span></label>
                            </div>
                            <span>非常にそう思う</span>
                        </div>
                    </div>
                    <div class="survey-question">
                        <p class="question-text">2. 食品を配置する作業は、直感的で分かりやすかった</p>
                        <div class="likert-scale">
                            <span>全くそう思わない</span>
                            <div class="likert-options">
                                <label><input type="radio" name="q2_intuitive" value="1" required><span>1</span></label>
                                <label><input type="radio" name="q2_intuitive" value="2"><span>2</span></label>
                                <label><input type="radio" name="q2_intuitive" value="3"><span>3</span></label>
                                <label><input type="radio" name="q2_intuitive" value="4"><span>4</span></label>
                                <label><input type="radio" name="q2_intuitive" value="5"><span>5</span></label>
                            </div>
                            <span>非常にそう思う</span>
                        </div>
                    </div>
                     <div class="survey-question">
                        <p class="question-text">3. 食品をどこに配置するか、判断に迷うことが多かった</p>
                        <div class="likert-scale">
                            <span>全くそう思わない</span>
                            <div class="likert-options">
                                <label><input type="radio" name="q3_confused" value="1" required><span>1</span></label>
                                <label><input type="radio" name="q3_confused" value="2"><span>2</span></label>
                                <label><input type="radio" name="q3_confused" value="3"><span>3</span></label>
                                <label><input type="radio" name="q3_confused" value="4"><span>4</span></label>
                                <label><input type="radio" name="q3_confused" value="5"><span>5</span></label>
                            </div>
                            <span>非常にそう思う</span>
                        </div>
                    </div>
                </fieldset>

                <fieldset class="survey-section">
                    <legend>B. ご自身の思考プロセスや戦略について</legend>
                    <div class="survey-question">
                        <p class="question-text">4. 実験を始める前に、ある程度の配置計画を立てていた</p>
                        <div class="likert-scale"><span></span><div class="likert-options"><label><input type="radio" name="q4_plan" value="1" required><span>1</span></label><label><input type="radio" name="q4_plan" value="2"><span>2</span></label><label><input type="radio" name="q4_plan" value="3"><span>3</span></label><label><input type="radio" name="q4_plan" value="4"><span>4</span></label><label><input type="radio" name="q4_plan" value="5"><span>5</span></label></div><span></span></div>
                    </div>
                    <div class="survey-question">
                        <p class="question-text">5. 個々の食品の関係よりも、全体のバランスを考えながら配置した</p>
                        <div class="likert-scale"><span></span><div class="likert-options"><label><input type="radio" name="q5_balance" value="1" required><span>1</span></label><label><input type="radio" name="q5_balance" value="2"><span>2</span></label><label><input type="radio" name="q5_balance" value="3"><span>3</span></label><label><input type="radio" name="q5_balance" value="4"><span>4</span></label><label><input type="radio" name="q5_balance" value="5"><span>5</span></label></div><span></span></div>
                    </div>
                    <div class="survey-question">
                        <p class="question-text">6. グループ分けをする際、見た目の類似性を重視した</p>
                        <div class="likert-scale"><span></span><div class="likert-options"><label><input type="radio" name="q6_visual" value="1" required><span>1</span></label><label><input type="radio" name="q6_visual" value="2"><span>2</span></label><label><input type="radio" name="q6_visual" value="3"><span>3</span></label><label><input type="radio" name="q6_visual" value="4"><span>4</span></label><label><input type="radio" name="q6_visual" value="5"><span>5</span></label></div><span></span></div>
                    </div>
                    <div class="survey-question">
                        <p class="question-text">7. グループ分けをする際、味や食文化といった抽象的な関連性を重視した</p>
                        <div class="likert-scale"><span></span><div class="likert-options"><label><input type="radio" name="q7_abstract" value="1" required><span>1</span></label><label><input type="radio" name="q7_abstract" value="2"><span>2</span></label><label><input type="radio" name="q7_abstract" value="3"><span>3</span></label><label><input type="radio" name="q7_abstract" value="4"><span>4</span></label><label><input type="radio" name="q7_abstract" value="5"><span>5</span></label></div><span></span></div>
                    </div>
                     <div class="survey-question">
                        <p class="question-text">8. 最終的な食品の配置とグループ分けに、自分自身で納得している</p>
                        <div class="likert-scale"><span></span><div class="likert-options"><label><input type="radio" name="q8_satisfied" value="1" required><span>1</span></label><label><input type="radio" name="q8_satisfied" value="2"><span>2</span></label><label><input type="radio" name="q8_satisfied" value="3"><span>3</span></label><label><input type="radio" name="q8_satisfied" value="4"><span>4</span></label><label><input type="radio" name="q8_satisfied" value="5"><span>5</span></label></div><span></span></div>
                    </div>
                </fieldset>

                <fieldset class="survey-section">
                    <legend>C. あなたの食生活について</legend>
                    <div class="survey-question">
                        <p class="question-text">9. 普段、どのくらいの頻度で自炊をしますか？</p>
                        <div class="likert-scale" id="q9_cooking_freq">
                            <label><input type="radio" name="q9_cooking_freq" value="1" required><span>全くしない</span></label>
                            <label><input type="radio" name="q9_cooking_freq" value="2"><span>月に数回</span></label>
                            <label><input type="radio" name="q9_cooking_freq" value="3"><span>週に1-2回</span></label>
                            <label><input type="radio" name="q9_cooking_freq" value="4"><span>週に3-5回</span></label>
                            <label><input type="radio" name="q9_cooking_freq" value="5"><span>ほぼ毎日</span></label>
                        </div>
                    </div>
                     <div class="survey-question">
                        <p class="question-text">10. 食や料理に対する関心は強い方だ</p>
                        <div class="likert-scale"><span></span><div class="likert-options"><label><input type="radio" name="q10_interest" value="1" required><span>1</span></label><label><input type="radio" name="q10_interest" value="2"><span>2</span></label><label><input type="radio" name="q10_interest" value="3"><span>3</span></label><label><input type="radio" name="q10_interest" value="4"><span>4</span></label><label><input type="radio" name="q10_interest" value="5"><span>5</span></label></div><span></span></div>
                    </div>
                     <div class="survey-question">
                        <p class="question-text">11. 冷凍食品を食べる機会は多い</p>
                        <div class="likert-scale"><span></span><div class="likert-options"><label><input type="radio" name="q11_frozen" value="1" required><span>1</span></label><label><input type="radio" name="q11_frozen" value="2"><span>2</span></label><label><input type="radio" name="q11_frozen" value="3"><span>3</span></label><label><input type="radio" name="q11_frozen" value="4"><span>4</span></label><label><input type="radio" name="q11_frozen" value="5"><span>5</span></label></div><span></span></div>
                    </div>
                    <div class="survey-question">
                        <p class="question-text">12. 今回の実験で表示された食品のうち、知らなかった、または何かわからなかったものがあれば、全てにチェックを入れてください。</p>
                        <div class="checkbox-group" id="q12_unknown_foods">
                            </div>
                    </div>
                </fieldset>

                <button id="submitAndFinishBtn" type="submit">アンケートを回答し、データを保存する</button>
            </form>
        </div>

        <div id="screen5" class="screen">
            <h2>実験にご協力いただきありがとうございました！</h2>
            <p>全データの保存が完了しました。ご協力に心より感謝申し上げます。</p>
            <p class="info-text">この画面を閉じていただいて結構です。</p>
            <button id="backToStartBtn2" class="back-button">最初の画面に戻る</button>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
